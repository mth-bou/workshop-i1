/*! cdn_sd_datasinks 2018-11-07 */
!function(a,b){"use strict";var c="default"in a?a.default:a,d="default"in b?b.default:b,e="1.1.0",f=function(a){return"function"==typeof a},g=function(a){return Array.prototype.slice.call(a,0)},h=function(a,b,c){return f(a[b])&&a[b].apply(a,c)},i=!1,j=void 0,k=!1,l=function(){return new j.contentWindow.XMLHttpRequest},m=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},n=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),o=function(){function a(b){m(this,a),this.queue=b||[]}return n(a,[{key:"process",value:function(a){this.queue.push(a);var b=this.queue;for(this.queue=[];0<b.length;){var c=b[0];try{if(c())break}catch(a){}b.shift()}this.queue=this.queue.concat(b)}}]),a}(),p=function(a){for(var b=d.cookie.split(";"),c=new RegExp("^\\s*"+a+"=\\s*(.*?)\\s*$"),e=0;e<b.length;e++){var f=b[e].match(c);if(f)return f[1]}},q=function(a){if(a){var b=a.split(".");return 3===b.length&&"ds1"===b[0]?b[2]:void 0}},r=function(b){return b?JSON.parse(a.atob(b)):void 0},s=function(c,e,f){for(var g,h,i=function(){var a=b.location.hostname.split("."),c=a[a.length-1],d=[];if(4===a.length&&!isNaN(Number(c)))return["none"];for(var e=a.length-2;e>=0;e--)d.push(a.slice(e).join("."));return d.push("none"),d}(),j=(g=e,a.btoa(JSON.stringify(g))),k=0;k<i.length;k++){var l=i[k],m=(h=j,"ds1."+l.split(".").length+"."+h),n=d.cookie;if(d.cookie=c+"="+m+"; "+("none"!==l?"domain="+l+"; ":"")+"path=/; expires="+f,n!==d.cookie||p(c)===m)return!0}},t=function(){function a(b){var c=b.pid,d=b.cookieName,e=b.cookieDuration;m(this,a),this.name=(d||"_ds")+"_"+c,this.expires=new Date((new Date).getTime()+864e5*(e||730)).toUTCString()}return n(a,[{key:"getItem",value:function(a){return(r(q(p(this.name)))||{})[a]}},{key:"setItem",value:function(a,b){var c=r(q(p(this.name)))||{};return c[a]=b,s(this.name,c,this.expires)}}]),a}(),u="tid",v=function(){try{var b=new Uint32Array(1);return a.crypto.getRandomValues(b),2147483647&b[0]}catch(b){return Math.round(2147483647*Math.random())}},w=function(){for(var a=[],b=0;256>b;b++)a[b]=(16>b?"0":"")+b.toString(16);var c=v(),d=v(),e=v(),f=v();return a[255&c]+a[c>>8&255]+a[c>>16&255]+a[c>>24&255]+"-"+a[255&d]+a[d>>8&255]+"-"+a[d>>16&15|64]+a[d>>24&255]+"-"+a[63&e|128]+a[e>>8&255]+"-"+a[e>>16&255]+a[e>>24&255]+a[255&f]+a[f>>8&255]+a[f>>16&255]+a[f>>24&255]},x=function(){function a(b){m(this,a),this.storage=b}return n(a,[{key:"init",value:function(a){var b=a.tid;return!this.storage.setItem(u,b||this.storage.getItem(u)||w())}},{key:"id",value:function(a){f(a)?a(this.storage.getItem(u)):this.storage.setItem(u,a||w())}},{key:"idSync",value:function(){return this.storage.getItem(u)}}]),a}(),y=function(){function a(b){var c=b.pid,d=b.api;m(this,a),this.pid=c,this.api=d}return n(a,[{key:"send",value:function(a,b){var c=l();c.open("POST",this.api,!0),c.onreadystatechange=function(){c.readyState===XMLHttpRequest.DONE&&b&&b(c.status,c.responseText)},c.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),c.send(["v=1","pid="+this.pid,"timestamp="+(new Date).getTime(),"data="+encodeURIComponent(JSON.stringify(a)),"lib="+encodeURIComponent(JSON.stringify({name:"ds-browser",version:e}))].join("&"))}}]),a}(),z=function(){function b(a){var c=a.uid,d=a.language;m(this,b),this._id=c,this._language=d||this._defaultLanguage()}return n(b,[{key:"_defaultLanguage",value:function(){return a.navigator&&(a.navigator.languages&&a.navigator.languages[0]||a.navigator.language||a.navigator.browserLanguage)||void 0}}]),n(b,[{key:"id",value:function(a){f(a)?a(this._id):this._id=a}},{key:"idSync",value:function(){return this._id}},{key:"language",value:function(a){f(a)?a(this._language):this._language=a||this._defaultLanguage()}},{key:"languageSync",value:function(){return this._language}}]),b}(),A=function(){function a(b,c){var d=b.pid,e=b.seg;m(this,a),this.api=e+"?pid="+d+"&tid="+c}return n(a,[{key:"retrieve",value:function(a){var b=l();b.open("GET",this.api,!0),b.onreadystatechange=function(){b.readyState===XMLHttpRequest.DONE&&200===b.status&&a&&a(JSON.parse(b.response))},b.send()}}]),a}(),B="optout",C="last",D="user",E=function(){function a(){m(this,a)}return n(a,[{key:"init",value:function(a,b){return!(a=a||{}).pid||(this._transport=new y(a),this._storage=new t(a),this._touchpoint=new x(this._storage),!!this._touchpoint.init(a)||(this._user=new z(a),this._segments=new A(a,this._touchpoint.idSync()),void(b&&b())))}},{key:"optout",value:function(a){return f(a)?a(this._storage.getItem(B)):!this._storage.setItem(B,a)}},{key:"touchpoint",value:function(){var a=g(arguments);return h(this._touchpoint,a[0],a.slice(1))}},{key:"user",value:function(){var a=g(arguments);return h(this._user,a[0],a.slice(1))}},{key:"record",value:function(a,b,c){var d=this;if(!this._storage.getItem(B)){var e={user_id:this._user.idSync(),touchpoint_id:this._touchpoint.idSync(),event:{type:a,timestamp:(new Date).getTime(),properties:b}},f=this._storage.getItem(C)||0,g=this._storage.getItem(D)||"",h=(new Date).getTime();(h>f+18e5||g!==(this._user.idSync()||""))&&(e.user={properties:{set:{platform:"web",language:this._user.languageSync()}}}),this._transport.send([e],function(a,b){200===a&&(d._storage.setItem(C,h),d._storage.setItem(D,d._user.idSync()||"")),c&&c(a,b)})}}},{key:"identify",value:function(a,b){if(!this._storage.getItem(B)){for(var c=a._q||Object.keys(a).map(function(b){return["set",b,a[b]]}),d=[],e={},f=0;f<c.length;f++){var h=g(c[f]),i=h[0],j=h[1],k=h[2];if(!("set"!==i&&"once"!==i&&"del"!==i&&"reset"!==i&&"inc"!==i||j&&-1!==d.indexOf(j)||"platform"===j||"inc"===i&&isNaN(Number(k))||"reset"===i&&0<Object.keys(e).length)){switch(i){case"set":case"once":(e[i]=e[i]||{})[j]=k;break;case"del":(e[i]=e[i]||[]).push(j);break;case"reset":e[i]=!0;break;case"inc":(e[i]=e[i]||{})[j]=Number(k)}if(j&&d.push(j),"reset"===i)break}}e.reset||((e.set=e.set||{}).platform="web",-1===d.indexOf("language")&&((e.set=e.set||{}).language=this._user.languageSync())),this._transport.send([{user_id:this._user.idSync(),touchpoint_id:this._touchpoint.idSync(),user:{properties:e}}],b)}}},{key:"segments",value:function(a){this._segments.retrieve(a)}}]),a}();a.__ds_loaded__||function(){c.__ds_loaded__=!0;var d=a.__ds_name__||"ds",f={},l={},m={},n=!0,p=function(a){return function(b,c){return"user"===b&&"traits"===c?function d(){(d._q=d._q||[]).push(Array.prototype.slice.call(arguments,0))}:(c=g(arguments),void l[a].process(function(){return h(f[a],c[0],c.slice(1))}))}},q=function(a){f[a]=new E;var b=(c[d][a]._q||[]).map(function(b){return function(){return b=g(b),h(f[a],b[0],b.slice(1))}});b.unshift(function(){return n}),l[a]=new o(b),m[a]=p(a)};for(var r in c[d])q(r);var s=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"_default";return c[d][a]||(l[a]=new o([function(){return n}]),f[a]=new E,c[d][a]=p(a)),c[d][a]};for(var r in s._version=e,c[d]=s,m)s[r]=m[r];var t,u=function(){},v=new o([function(){return!i},function(){return!k},function(){for(var a in n=!1,l)l[a].process(u)}]);t=function(){return v.process(u)},"preview"!==a.navigator.loadPurpose&&("prerender"!==b.visibilityState?(i=!0,t()):b.addEventListener("visibilitychange",function w(){b.removeEventListener("visibilitychange",w),i=!0,t()})),function(a){(j=b.createElement("iframe")).style.display="none",j.addEventListener("load",function(){k=!0,a()});try{b.body.appendChild(j)}catch(a){b.addEventListener("DOMContentLoaded",function(){return b.body.appendChild(j)})}}(function(){return v.process(u)})}()}(window,document);