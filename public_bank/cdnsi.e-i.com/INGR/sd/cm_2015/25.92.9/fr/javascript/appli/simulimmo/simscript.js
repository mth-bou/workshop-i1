function Affect_Donnee_Besson(e){switch(trim(e)){case"MT_DEDUC":return void document.write(NombreEcran(ValParam("mt_deduc")));case"GAIN_FISCAL5":return void document.write(NombreEcran(ValParam("gain_fiscal5")));case"T_FISCAL5":return void document.write(NombreEcran(ValParam("t_fiscal5")));case"MT_DEDUC2":return void document.write(NombreEcran(ValParam("mt_deduc2")));case"GAIN_FISCAL15":return void document.write(NombreEcran(ValParam("gain_fiscal15")));case"T_FISCAL15":return void document.write(NombreEcran(ValParam("t_fiscal15")));case"GAIN_TOTAL":return void document.write(NombreEcran(ValParam("gain_total")));case"GAIN_FISC_TOT":var t=parse10(ValParam("mt_deduc"))+parse10(ValParam("mt_deduc2"));return void document.write(NombreEcran(t));case"TX_IMPOS":return void document.write(ValParam("tx_impos"));case"MT_INVEST":return void document.write(NombreEcran(ValParam("mt_invest")))}}function Affect_Donnee_Not(e){switch(trim(e)){case"FRAIS_NOT":return""==ValParam("frais_not")?void document.write("<td >&nbsp;</td><td >&nbsp;</td><td >&nbsp;</td>"):void document.write("<td class=FSTABU width=20%>&nbsp;</td><td class=FSTABU>&nbsp;</td><td align=left class=FSTABU nowrap>Frais de notaire :&nbsp;</td><td class=FSTABU nowrap>"+NombreEcran(ValParam("frais_not"))+" "+DeviseEcran+"</td><td class=FSTABU width=20%>&nbsp;</td>")}}function Affect_Donnee_PTZ(e){switch(trim(e)){case"ACHAT_MNT":return void document.write(NombreEcran(ValParam("mt_achat")));case"REVENUS":return void document.write(NombreEcran(ValParam("revenus")));case"NB_PSN":return"1"==ValParam("nb_psn")?void document.write(ValParam("nb_psn")+" personne"):void document.write(ValParam("nb_psn")+" personnes");case"RES_PRET":return void document.write(NombreEcran(ValParam("mt_pret")));case"RES_DUREE":return void document.write(Recomposition(ValParam("duree")));case"RES_DUREE1":return""==ValParam("duree1")||"0"==ValParam("duree1")?void document.write(""):void document.write("Pendant "+Recomposition(ValParam("duree1")));case"RES_DUREE2":return""==ValParam("duree2")||"0"==ValParam("duree2")?void document.write(""):void document.write("Puis, pendant "+Recomposition(ValParam("duree2")));case"RES_MENS1":return"0"==ValParam("mens1")||""==ValParam("mens1")?void document.write("vous n'aurez rien \ufffd rembourser."):void document.write("vous aurez une mensualit\ufffd de "+NombreEcran(ValParam("mens1"))+" "+DeviseEcran+".");case"RES_MENS2":return"0"==ValParam("mens2")||""==ValParam("mens2")?void document.write(""):void document.write("vous aurez une mensualit\ufffd de "+NombreEcran(ValParam("mens2"))+" "+DeviseEcran+".");case"LIEU":return void document.write("Zone "+ValParam("lieu"))}}function Cre_Tab_End(){var e,t,r=0;for(e=0;e<30;e++){if(""==ValParam_Tab("mens",e))return;r=0==r?(t="class='SPAIRE'",1):(t="class='SIMPAIRE'",0),document.writeln("<tr>"),document.writeln("<td align='center' "+t+">"+ValParam_Tab("duree",e)+"</td>"),document.writeln("<td align='right' "+t+">"+NombreEcran(ValParam_Tab("mens",e))+"</td>"),document.writeln("<td align='right' "+t+">"+ValParam_Tab("tx_end",e)+" %</td>"),document.writeln("</tr>")}}function Affect_Donnee_Cha(e){switch(trim(e)){case"PRET_TX_ENDET":return void document.write(ValParam("tx_end"));case"PRET_DUREE":return void document.write(Recomposition(ValParam("duree")));case"MENS":return void document.write(NombreEcran(ValParam("mens")));case"MNT":return void document.write(NombreEcran(ValParam("mnt")));case"TX_ANNUEL":return void document.write(ValParam("tx_ann"));case"REVENUS":return void document.write(NombreEcran(ValParam("totrev")));case"CHARGES":return"0"==ValParam("totcha")?void document.write("0"):void document.write(NombreEcran(ValParam("totcha")));case"INFO":if(30<ValParam("tx_end"))return void document.write("<TD COLSPAN=2 class=FINFO>Attention : vous d\ufffdpassez le taux maximum de 30% d'endettement habituellement autoris\ufffd par les organismes financiers.<br>Veuillez opter pour une mensualit\ufffd moins \ufffdlev\ufffde.</td>")}}function Cre_Tab_Emp(){var e,t,r=0;for(e=0;e<15;e++){if(""==ValParam_Tab("mens",e))return;r=0==r?(t="class='SPAIRE'",1):(t="class='SIMPAIRE'",0),document.writeln("<tr>"),document.writeln("<td align='right' "+t+">"+ValParam_Tab("tx_end",e)+" %</td>"),document.writeln("<td align='right' "+t+">"+NombreEcran(ValParam_Tab("mt_pret",e))+"</td>"),document.writeln("<td align='right' "+t+">"+NombreEcran(ValParam_Tab("mens",e))+"</td>"),document.writeln("</tr>"),t="class='SPAIRE'"}}function Affect_Donnee_Emp(e){switch(trim(e)){case"RES_MNT":return void document.write(NombreEcran(ValParam("mt_pret")));case"RES_MENS":return void document.write(NombreEcran(ValParam("mens")));case"REVENUS":return void document.write(NombreEcran(ValParam("totrev")));case"CHARGES":return"0"==ValParam("totcha")?void document.write("0"):void document.write(NombreEcran(ValParam("totcha")));case"PRET_DUREE":return void document.write(ValParam("duree")+" ans");case"TX_ANNUEL":return void document.write(Arrondi(ValParam("tx_annuel")))}}function Annee_N1(){var e=(new Date).getYear();e<1970&&(e=1900+e),an1=e-1,document.write(an1)}var iedom=!!document.all;function FindMenuItem(e){if(iedom)for(var t=document.all.tags("A"),r=0;r<t.length;r++){var a=t[r].href.indexOf(e);t[r].className=0<a?"MenuItemSel":"MenuItemUnsel"}}function p_open(e){FindMenuItem(e),document.location.href=e}function NombreEcran(e){return FormatNumber(e,"# ###,##")}function EcranNombre(e){return UnFormatNumber(e)}function FormatNumber(e,t){var r,a,n,o,i=e.toString(),u=i.indexOf("."),s="";if(0==e)return"";for(0==(o=t.indexOf(","))&&(o=t.indexOf(".")),0<=o?(n=t.length-o-1,t=t.substr(0,o)):n=0,0<=u?i=i.substr(0,u)+","+i.substr(u+1):i+=",",u=i.indexOf(","),r=i.substr(0,u),a=i.substr(u+1);0<t.length;)o=t.substr(t.length-1,1),t=t.substr(0,t.length-1),"#"!=o?" "==o&&""==r||(s=o+s):0<r.length&&(s=r.substr(r.length-1,1)+s,r=r.substr(0,r.length-1));for(s=r+s,0<n&&(s+=",");0<n;)""==(o=a.substr(0,1))&&(o="0"),s+=o,a=a.substr(1),--n;return s}function UnFormatNumber(e){var t,r,a="";for(t=0;t<e.length;t++)","==(r=e.substr(t,1))||"."==r?r=".":(r<"0"||"9"<r)&&(r=""),a+=r;return""==a?0:parseFloat(a)}function Puiss(e,t){for(Resultat=e,i=1;i<t;i++)Resultat*=e;return Resultat}function Arrondi(e){return Resultat=parse10(100*e)/100,Resultat}function Decomposition(e){return Annee=parse10(e),Mois=parse10(12*(e-Annee)),Retour=Mois+" mois",1<Annee&&(S="s "),0<Annee&&(Retour=Annee+" an".S+" et "+Retour),Retour}function Recomposition(e){return Annee=parse10(e/12),Mois=parse10(e-12*Annee),S="",Retour="",1<Annee&&(S="s"),0<Annee&&(Retour=Annee+" an"+S),Annee&&Mois&&(Retour+=" et "),0<Mois&&(Retour=Retour+Mois+" mois"),Retour}function ValeurLB(e){return e.options[e.selectedIndex].value}function ValParam_Tab(e,t){for(var r=new Array,a=0,n=0;n<param_page.length;n++)if((r=param_page[n].split("=")).length&&r[0].toLowerCase()==e.toLowerCase()){if(a==t)return r[1].toUpperCase();a++}return""}function ValParam(e){for(var t=new Array,r=0;r<param_page.length;r++)if((t=param_page[r].split("=")).length&&t[0].toLowerCase()==e.toLowerCase())return t[1].toUpperCase();return""}var param_pages=document.location.search.substr(1),param_page=new Array;param_page=param_pages.split("&");var DeviseOpposee,DeviseEcran=ValParam("deviseEcran");function BoutonFlipFlop(){document.write("<a href='javascript:FlipFlop();'>"),"FRF"==DeviseEcran?document.write("<IMG border=0 height=27 src='images/appli/SIMIMMO/fr_euro.gif' width=60 alt='Nouvelle simulation en EURO'>"):document.write("<IMG border=0 height=27 src='images/appli/SIMIMMO/euro_fr.gif' width=60 alt='Nouvelle simulation en FRANCS'>"),document.write("</a>")}function BoutonFlipFlopRes(){document.write("<a href='javascript:FlipFlopRes();'>"),"FRF"==DeviseEcran?document.write("<IMG border=0 height=27 src='images/appli/SIMIMMO/fr_euro.gif' width=60 alt='R\ufffdsultats simulation en EURO'>"):document.write("<IMG border=0 height=27 src='images/appli/SIMIMMO/euro_fr.gif' width=60 alt='R\ufffdsultats simulation en FRANCS'>"),document.write("</a>")}function DeviseEcranCourt(){document.write(DeviseEcran)}function DeviseEcranLg(){"EUR"==DeviseEcran?document.write("EUR"):document.write("FRF")}function DeviseEcranTitre(){"EUR"==DeviseEcran?document.write("l'EURO"):document.write("le FRANC")}function trim(e){for(var t=e.toString(),r=0,a=t.length-1;r<=a&&" "==t.substr(r,1);)r++;for(;0<=a&&" "==t.substr(a,1);)a--;return a<r?"":t.substring(r,a+1)}function ShowError(e,t){return alert(t),e.focus(),!1}function DateJour(){var e,t=new Date;return e=t.getFullYear()+"",e+=t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1,e+=t.getDate()<10?"0"+t.getDate():t.getDate()}function FormatDate8_10(e){return""==trim(e)?"":10==e.lentgh?e:e.substr(6,2)+"/"+e.substr(4,2)+"/"+e.substr(0,4)}function FormatDate10_8(e){return""==trim(e)?"":8==e.lentgh?e:e.substr(6,4)+e.substr(3,2)+e.substr(0,2)}function Date8(e){var t;return t=e.getFullYear()+"",t+=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,t+=e.getDate()<10?"0"+e.getDate():e.getDate()}function DatePlusM(e,t){return new Date(Number(e.substr(0,4)),Number(e.substr(4,2))-1+t,Number(e.substr(6,2)))}function ControleDate(e){var t=e.value.split("/");if(0==trim(e.value).length)return alert("Date obligatoire"),e.focus(),!0;if(1==t.length&&(t=e.value.split(".")),1==t.length&&(t=e.value.split("-")),1==t.length){if(6!=t[0].length&&8!=t[0].length)return alert("Date erron\ufffde"),e.focus(),!0;t[0]=e.value.substr(0,2),t[1]=e.value.substr(2,2),t[2]=e.value.substr(4,4)}return 2==t.length&&(t[2]=(new Date).getFullYear().toString()),2!=t[2].length&&4!=t[2].length?(alert("Date erron\ufffde (ann\ufffde)"),e.focus(),!0):(1==t[0].length&&(t[0]="0"+t[0]),t[0]=""+t[0],1==t[1].length&&(t[1]="0"+t[1]),t[1]=""+t[1],2==t[2].length&&(40<t[2]?t[2]="19"+t[2]:t[2]="20"+t[2]),t[2]=""+t[2],e.value=t[0]+"/"+t[1]+"/"+t[2],t[0]<"01"||"31"<t[0]?(alert("Date erron\ufffde (jour)"),e.focus(),!0):t[1]<"01"||"12"<t[1]?(alert("Date erron\ufffde (mois)"),e.focus(),!0):(t[2]<"1890"||"2099"<t[2])&&(alert("Date erron\ufffde (ann\ufffde)"),e.focus(),!0))}function LBGetValue(e){return 0<=e.selectedIndex?e.options[e.selectedIndex].value:""}function LBSelectByValue(e,t){e.selectedIndex=-1;for(var r=0;r<e.options.length;r++)e.options[r].value==t&&(e.selectedIndex=r)}function parse10(e){return parseInt("0"+e,10)}""==DeviseEcran&&(DeviseEcran=new Date<new Date(2002,1,1)?"FRF":"EUR"),DeviseOpposee="EUR"==DeviseEcran?"FRF":"EUR";