function getVar(e,t){null==t&&(t=0),e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a=new RegExp("[\\?&#]"+e+"=([^&#]*)").exec(window.location.href);return null==a?t:a[1]}function validateInput(field){var target="",radioName,radioName,patt,target=0<$(".cc .form-control").length?".form-control":".form__control";return valid=!0,$("#err-msg-"+$(field).attr("id")).remove(),"checkbox"==$(field).attr("type")||"radio"==$(field).attr("type")?($(".i_blocgenform").find("[data-required-if^='@"+$(field).attr("name")+"']").each(function(){$(this).parent().removeClass("invalid"),$(this).parent().removeClass("valid"),$(this).parents(target).find(".err-msg").remove()}),$(field)[0].checkValidity()?("radio"==$(field).attr("type")?(radioName=$(field).attr("name"),$(".i_blocgenform input:radio[name='"+radioName+"']").parents(target).find(".err-msg").remove(),$(".i_blocgenform input:radio[name='"+radioName+"']").parent().removeClass("invalid")):$(field).parent().removeClass("invalid"),$(field).parent().addClass("valid")):(valid=!1,$(field).parent().removeClass("valid"),$(field).parent().addClass("invalid"),"radio"==$(field).attr("type")?(radioName=$(field).attr("name"),$(field).index("input:radio[name='"+radioName+"']")==$(".i_blocgenform input:radio[name='"+radioName+"']").length-1&&$(field).parents(target).append('<span class="err-msg" id="err-msg-'+$(field).attr("id")+'">'+$(field).attr("data-err-msg")+"</span>")):$(field).parents(target).append('<span class="err-msg" id="err-msg-'+$(field).attr("id")+'">'+$(field).attr("data-err-msg")+"</span>"))):$(field)[0].checkValidity()?($(field).parent().removeClass("invalid"),$(field).parent().addClass("valid"),$("#err-msg-"+$(field).attr("id")).remove()):""===$(field).attr("value")||void 0===$(field).attr("value")?(valid=!1,$(field).parent().removeClass("valid"),$(field).parent().addClass("invalid"),$(field).parents(target).append('<span class="err-msg" id="err-msg-'+$(field).attr("id")+'">'+$(field).attr("data-err-msg")+"</span>")):"email"==$(field).attr("type")?(valid=!1,$(field).parent().removeClass("valid"),$(field).parent().addClass("invalid"),$(field).parents(target).append('<span class="err-msg" id="err-msg-'+$(field).attr("id")+'">'+$(field).attr("data-err-format-msg")+"</span>")):$(field).attr("min")||$(field).attr("max")?(eval($(field).attr("value")+"<"+$(field).attr("min"))||eval($(field).attr("value")+">"+$(field).attr("max")))&&(valid=!1,$(field).parent().removeClass("valid"),$(field).parent().addClass("invalid"),$(field).parents(target).append('<span class="err-msg" id="err-msg-'+$(field).attr("id")+'">'+$(field).attr("data-err-size-msg")+"</span>")):(patt=new RegExp($(field).attr("pattern")),RegExp($(field).attr("pattern")).test($(field).attr("value"))||(valid=!1,$(field).parent().removeClass("valid"),$(field).parent().addClass("invalid"),$(field).parents(target).append('<span class="err-msg" id="err-msg-'+$(field).attr("id")+'">'+$(field).attr("data-err-size-msg")+"</span>"))),valid}function validateTextarea(e){var t="",t=0<$(".cc .form-control").length?".form-control":".form__control";return valid=!0,$(e)[0].checkValidity()?($("#err-msg-"+$(e).attr("id")).remove(),$(e).parent().addClass("valid"),$(e).parent().removeClass("invalid")):(valid=!1,$("#err-msg-"+$(e).attr("id")).remove(),$(e).parent().removeClass("valid"),$(e).parent().addClass("invalid"),$(e).parents(t).append('<span class="err-msg" id="err-msg-'+$(e).attr("id")+'">'+$(e).attr("data-err-msg")+"</span>")),valid}function validateSelect(e){var t="",t=0<$(".cc .form-control").length?".form-control":".form__control";return valid=!0,$(e)[0].checkValidity()||""!==$(e).val()?($("#err-msg-"+$(e).attr("id")).remove(),$(e).parent().addClass("valid"),$(e).parent().removeClass("invalid")):(valid=!1,$("#err-msg-"+$(e).attr("id")).remove(),$(e).parent().removeClass("valid"),$(e).parent().addClass("invalid"),$(e).parents(t).append('<span class="err-msg" id="err-msg-'+$(e).attr("id")+'">'+$(e).attr("data-err-msg")+"</span>")),valid}function initRequired(){$(".i_blocgenform input[type='text'],.i_blocgenform input[type='email'],.i_blocgenform input[type='number']").off("keyup blur").on("keyup blur",function(e){validateInput(this)}),$(".i_blocgenform input[type='radio'],.i_blocgenform input[type='checkbox']").off("change").on("change",function(e){validateInput(this)}),$(".i_blocgenform textarea").off("blur").on("blur",function(e){validateTextarea(this)}),$(".i_blocgenform select").off("change blur").on("change blur",function(e){validateSelect(this)})}function initRules(){for($("[data-trigger]").each(function(e){$(this).removeAttr("data-trigger")}),$("[data-displayed-if]").each(function(e){$(this).attr("id")?cible=$(this).attr("id"):(cible="datadisplayedif"+e,$(this).attr("id",cible)),FRMrules.push(new Rule($(this).attr("data-displayed-if"),[cible],"display"))}),$("[data-disabled-if]").each(function(e){$(this).attr("id")?cible=$(this).attr("id"):(cible="datadisplayedif"+e,$(this).attr("id",cible)),FRMrules.push(new Rule($(this).attr("data-disabled-if"),[$(this).attr("id")],"disabled"))}),$("[data-required-if]").each(function(e){$(this).attr("id")?cible=$(this).attr("id"):(cible="datadisplayedif"+e,$(this).attr("id",cible)),FRMrules.push(new Rule($(this).attr("data-required-if"),[$(this).attr("id")],"required"))}),i=0;i<FRMrules.length;i++)FRMrules[i].n=i,FRMrules[i].initRule()}function initRule(){if(this.rule=this.rule.replace(/#/g,""),null!=this.elts){for(e=0;e<this.elts.length;e++){var a=0;this.elts[e]=this.elts[e].replace("#",""),$("[name^='"+this.elts[e]+"']").attr("data-trigger")?-1==$("[name^='"+this.elts[e]+"']").attr("data-trigger").indexOf(this.n)&&$("[name^='"+this.elts[e]+"']").attr("data-trigger",$("[name^='"+this.elts[e]+"']").attr("data-trigger")+","+this.n):($("[name^='"+this.elts[e]+"']").attr("data-trigger",this.n),a=1),1==a&&$("[name^='"+this.elts[e]+"']").each(function(){$(this).change(function(){for(triggers=$(this).attr("data-trigger").split(","),t=0;t<triggers.length;t++)FRMrules[triggers[t]].evalRule()})})}this.evalRule()}}function evalRule(){for(theRule=this.rule.replace(/@/g,""),e=0;e<this.elts.length;e++)theRule=theRule.replace(this.elts[e],"'"+getValue(this.elts[e])+"'");if(eval(theRule))for(j=0;j<this.IfTrue.length;j++){var target=this.IfTrue[j].replace(/(:|\.|\[|\]|,|=)/g,"\\$1");switch(this.ruleType){case"display":$("#"+target).show("easing"),$("#"+target).attr("aria-hidden","false");break;case"disabled":$("#"+target).prop("disabled",!1);break;case"required":$("#"+target).attr("aria-required","true"),$("#"+target).attr("required","required")}}else for(j=0;j<this.IfTrue.length;j++)if(null!=this.IfTrue[j]&&null!=this.IfTrue[j]){var target=this.IfTrue[j].replace(/(:|\.|\[|\]|,|=)/g,"\\$1");switch(this.ruleType){case"display":$("#"+target).hide("easing"),$("#"+target).attr("aria-hidden","true");break;case"disabled":$("#"+target).prop("disabled",!0);break;case"required":$("#"+target).attr("aria-required","false"),$("#"+target).removeAttr("required")}}}function getValue(e){var t,a=$("[name^='"+e.replace("#","")+"']"),i="";return a.length&&("checkbox"==(t=a.prop("type"))||"radio"==t?a.each(function(e){$(this).prop("checked")&&(i=""==i?$(this).val():i+";"+$(this).val())}):i=a.val()),i}function Rule(e,t,a){this.n,this.elts=e.replace(/@/g,"#").match(/#(.+?)(?=[\=\>\<\!]|$)/gi),this.rule=e.replace(/=/g,"==").replace(/ or /gi,"||").replace(/ and /gi,"&&"),this.IfTrue=t,this.ruleType=a,this.initRule=initRule,this.evalRule=evalRule}var FRMrules=[];function addRule(e,t,a){a=a||"display",FRMrules.push(new Rule(e,t,a))}function initSteps(){var t=$("#ei_tpl_head").height()+3,a=900;$("form[data-formsteps='true']").each(function(e){zeForm=$(this),divSteps='<div class="steps" id="steps'+(i+1)+'"><ol>',nSteps=0,$(this).find("fieldset").each(function(e){nSteps++,$(this).attr("id","fieldset"+(e+1)),divSteps+='<li id="step'+(e+1)+'" data-step="'+(e+1)+'">'+$(this).find("legend").html()+"</li>",$(this).append('<div class="form-buttons"><button class="button prev" id="prev'+(e+1)+'">Précédent</button><button class="button next" id="next'+(e+1)+'">Suivant</button></div>'),$(this).find("#prev"+(e+1)).click(function(){return zeForm.attr("data-step",e),$("#fieldset"+e+" input:first").focus(),sectionOffsetTop=Math.floor($("li#step"+e).offset().top-t),$("html, body").animate({scrollTop:sectionOffsetTop},a),!1}),$(this).find("#next"+(e+1)).click(function(){return valid=!0,$("#fieldset"+(e+1)+" input").each(function(e){valid&=validateInput(this)}),$("#fieldset"+(e+1)+" textarea").each(function(e){valid&=validateTextarea(this)}),valid?(zeForm.attr("data-step",e+2),$("#fieldset"+(e+2)+" input:first").focus(),sectionOffsetTop=Math.floor($("li#step"+(e+2)).offset().top-t),$("html, body").animate({scrollTop:sectionOffsetTop},a)):$(".form-group.invalid:first").each(function(e){$(this).find("input:first").focus(),sectionOffsetTop=Math.floor($(this).offset().top-t),$("html, body").animate({scrollTop:sectionOffsetTop},a)}),!1})}),divSteps+="</ol></di>",$(this).prepend(divSteps),$(this).attr("data-step",1),$(this).attr("data-steps",nSteps),$("#prev1").remove(),$("#next"+nSteps).replaceWith('<button class="button" type="submit">Envoyer</button>'),$(".steps li").click(function(){n=$(this).attr("data-step"),n<zeForm.attr("data-step")&&(zeForm.attr("data-step",n),$("#fieldset"+n+" input:first").focus(),sectionOffsetTop=Math.floor($("li#step"+n).offset().top-t),$("html, body").animate({scrollTop:sectionOffsetTop},a))})})}$(document).ready(function(){initSteps(),initRequired(),initRules(),$(".i_blocgenform > form button[type='submit']").click(function(e){e.preventDefault(),e.stopPropagation();var t=[];$(".i_blocgenform input:visible").each(function(){t.push(validateInput(this))}),$(".i_blocgenform textarea:visible").each(function(){t.push(validateTextarea(this))}),$(".i_blocgenform select:visible").each(function(){t.push(validateSelect(this))}),-1===t.indexOf(!1)&&($(".i_blocgenform > form button[type='submit']").attr("disabled","disabled"),$(".i_blocgenform > form").submit());var a,i=0;$("*[data-sticky]").each(function(){i+=$(this).outerHeight()}),$(".form-group.invalid").each(function(){return a=$(this).offset().top,$(this).focus(),$("html,body").scrollTop(a-(i+10)),!1});var r=/(2019|202[0-9])\-(0[1-9]|1[012])\-(0[1-9]|[12][0-9]|3[01])/;$(".i_blocgenform input[type='date']").each(function(){var e;$(this).val().match(r)&&($(this).attr("type","text"),e=$(this).val().split("-"),$(this).val(e[2]+"/"+e[1]+"/"+e[0]))}),window.history.replaceState(null,null,window.location.pathname)}),$(".cc #hidPage").length&&$(".cc #hidPage").attr("value",document.location.href),$(".cc #hidPagePrec").length,$(".cc #hidPagePrec").attr("value",document.referrer),0!=getVar("procom")&&$(".cc #hidProcom").length&&$(".cc #hidProcom").attr("value",getVar("procom"));for(var e=location.search.substring(1).split("&"),t=0;t<e.length;t++){var a,i,r,l,s=e[t].split("=");""!=s[0]&&null!=s[0]&&(""===(a=s[0].split("_"))[0]&&(a[0]=void 0),i=$(".cc .i_blocgenform form #"+a[0]),r=unescape(s[1]),i.length?"checkbox"==i.attr("type")?"1"==r?i.prop("checked",!0):i.prop("checked",!1):i.is("select")?i.find("option[value='"+decodeURIComponent(s[1])+"']").prop("selected",!0):i.attr("value",r):!$('input[name="'+s[0]+'"]').length||"radio"!=$('input[name="'+s[0]+'"]').attr("type")||1<(l=$('input[name="'+s[0]+'"]')).length&&l.each(function(){$(this).val()==r&&$(this).prop("checked",!0)}))}});